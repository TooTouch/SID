# Detecting Adversarial Examples from Sensitivity Inconsistency of Spatial-Transform Domain

Pytorch re-implementation for "Detecting Adversarial Examples from Sensitivity Inconsistency of Spatial-Transform Domain". AAAI 2021

- **paper**: [Detecting Adversarial Examples from Sensitivity Inconsistency of Spatial-Transform Domain](https://arxiv.org/abs/2103.04302)
- **official code**: https://github.com/JinyuTian/SID


# Run

run [`./scripts/run_pipeline.sh`](https://github.com/TooTouch/SID/blob/main/scripts/run_pipeline.sh)


**run_pipeline.sh**

```bash
modelname="resnet34 vgg19"
adv_method_list=("DeepFool" "BIM" "CW" "CW" "FAB" "FGSM" "PGD" "PGD" "PGD")
adv_expname_list=("DeepFool" "BIM" "CW" "Low_CW" "FAB" "FGSM" "PGD" "Low_PGD1" "Low_PGD2")
dataname_list="CIFAR10 SVHN CIFAR100"


for dataname in $dataname_list
do
    # 1. train classifier
    bash run_classifier.sh $modelname $dataname 

    # 2. make adversarial examples
    for i in ${!adv_method_list[*]}
    do
        bash save_adv_samples.sh $modelname ${adv_method_list[$i]} ${adv_expname_list[$i]} $dataname
    done

    # 3. known attack
    for i in ${!adv_method_list[*]}
    do
        bash known_attack.sh $modelname ${adv_expname_list[$i]} $dataname
    done

    # 4. transfer attack
    bash run_transfer_attack.sh $modelname $dataname 

done
```

# Results

- **Model**: ResNet34, VGG19

## 1. Adversarial Attacks


**CIFAR10**

- VGG19

|          |   Adv Acc(%) |   Adv Acc(%) DWT |   # Success Images |
|:---------|-------------:|-----------------:|-------------------:|
| DeepFool |         1.30 |            84.73 |               7117 |
| BIM      |         0.00 |            63.03 |               7213 |
| CW       |        12.44 |            80.84 |               5993 |
| Low_CW   |        52.96 |            87.62 |               2399 |
| FAB      |         0.03 |            87.52 |               7240 |
| FGSM     |        13.82 |            59.65 |               5872 |
| PGD      |         0.00 |            64.92 |               7204 |
| Low_PGD1 |        59.34 |            86.90 |               1879 |
| Low_PGD2 |        15.96 |            84.40 |               5618 |


- ResNet34

|          |   Adv Acc(%) |   Adv Acc(%) DWT |   # Success Images |
|:---------|-------------:|-----------------:|-------------------:|
| DeepFool |         5.59 |            90.66 |               6576 |
| BIM      |         0.08 |            63.94 |               7022 |
| CW       |        22.66 |            83.57 |               4852 |
| Low_CW   |        58.79 |            91.86 |               1973 |
| FAB      |         0.00 |            92.13 |               7021 |
| FGSM     |        35.80 |            66.79 |               3825 |
| PGD      |         0.06 |            67.95 |               7009 |
| Low_PGD1 |        60.67 |            90.90 |               1704 |
| Low_PGD2 |        14.40 |            88.23 |               5606 |


**CIFAR100**

- VGG19

|          |   Adv Acc(%) |   Adv Acc(%) DWT |   # Success Images |
|:---------|-------------:|-----------------:|-------------------:|
| DeepFool |         2.90 |            57.60 |               2961 |
| BIM      |         1.72 |            44.59 |               2950 |
| CW       |         9.35 |            52.97 |               2245 |
| Low_CW   |        30.82 |            59.30 |               1187 |
| FAB      |         5.31 |            59.14 |               2865 |
| FGSM     |        16.79 |            35.40 |               1826 |
| PGD      |         1.32 |            45.68 |               2943 |
| Low_PGD1 |        29.61 |            58.47 |               1190 |
| Low_PGD2 |         9.72 |            56.72 |               2325 |


- ResNet34

TBD




**SVHN**

- VGG19

|          |   Adv Acc(%) |   Adv Acc(%) DWT |   # Success Images |
|:---------|-------------:|-----------------:|-------------------:|
| DeepFool |         1.40 |            54.58 |              23937 |
| BIM      |         1.05 |            29.90 |              24015 |
| CW       |        15.68 |            69.78 |              20208 |
| Low_CW   |        74.88 |            92.11 |               4829 |
| FAB      |         0.74 |            90.69 |              24116 |
| FGSM     |        20.19 |            44.18 |              19039 |
| PGD      |         1.26 |            31.61 |              23982 |
| Low_PGD1 |        81.78 |            91.85 |               3085 |
| Low_PGD2 |        52.86 |            83.10 |              10551 |

- ResNet34

|          |   Adv Acc(%) |   Adv Acc(%) DWT |   # Success Images |
|:---------|-------------:|-----------------:|-------------------:|
| DeepFool |         4.28 |            78.80 |              23173 |
| BIM      |         2.42 |            31.17 |              23615 |
| CW       |        33.62 |            74.71 |              15495 |
| Low_CW   |        76.69 |            93.47 |               4394 |
| FAB      |         1.24 |            93.41 |              23938 |
| FGSM     |        40.35 |            55.49 |              13760 |
| PGD      |         2.74 |            33.89 |              23566 |
| Low_PGD1 |        81.72 |            92.56 |               3142 |
| Low_PGD2 |        49.66 |            83.99 |              11355 |



## 2. Known Attacks 

**CIFAR10**

- VGG19

|          |   AUROC(%) |   Detection Acc(%) | #(train, dev, test)   |
|:---------|-----------:|-------------------:|:----------------------|
| DeepFool |      91.76 |              86.14 | (4528, 754, 2265)     |
| BIM      |      99.79 |              98.27 | (5245, 874, 2624)     |
| CW       |      88.31 |              81.62 | (3896, 648, 1952)     |
| Low_CW   |      90.99 |              85.94 | (1574, 261, 790)      |
| FAB      |      97.3  |              92.56 | (4629, 770, 2317)     |
| FGSM     |      90.67 |              83.96 | (4207, 700, 2108)     |
| PGD      |      99.67 |              98    | (5161, 859, 2585)     |
| Low_PGD1 |      80.74 |              74.68 | (1252, 208, 630)      |
| Low_PGD2 |      89.74 |              85.5  | (3596, 598, 1801)     |


- ResNet34

|          |   AUROC(%) |   Detection Acc(%) | #(train, dev, test)   |
|:---------|-----------:|-------------------:|:----------------------|
| DeepFool |      92.94 |              89.10 | (4112, 684, 2059)     |
| BIM      |      99.39 |              97.18 | (5085, 846, 2546)     |
| CW       |      90.28 |              84.19 | (3184, 530, 1596)     |
| Low_CW   |      82.58 |              79.17 | (1267, 210, 637)      |
| FAB      |      95.76 |              92.10 | (4399, 732, 2204)     |
| FGSM     |      94.89 |              88.94 | (2863, 476, 1433)     |
| PGD      |      99.28 |              96.39 | (4935, 821, 2472)     |
| Low_PGD1 |      82.95 |              78.13 | (1102, 183, 553)      |
| Low_PGD2 |      90.07 |              85.16 | (3519, 586, 1761)     |


**CIFAR100**

- VGG19

|          |   AUROC(%) |   Detection Acc(%) | #(train, dev, test)   |
|:---------|-----------:|-------------------:|:----------------------|
| DeepFool |      80.40 |              73.61 | (1893, 315, 949)      |
| BIM      |      86.14 |              78.24 | (1879, 312, 943)      |
| CW       |      72.53 |              68.66 | (1461, 243, 734)      |
| Low_CW   |      59.76 |              59.38 | (779, 129, 392)       |
| FAB      |      76.26 |              70.87 | (1836, 305, 920)      |
| FGSM     |      63.77 |              62.82 | (1247, 206, 627)      |
| PGD      |      87.85 |              81.94 | (1872, 310, 940)      |
| Low_PGD1 |      55.68 |              58.55 | (782, 129, 395)       |
| Low_PGD2 |      66.83 |              67.21 | (1483, 246, 745)      |



- ResNet34

TBD



**SVHN**

- VGG19

|          |   AUROC(%) |   Detection Acc(%) | #(train, dev, test)   |
|:---------|-----------:|-------------------:|:----------------------|
| DeepFool |      95.40 |              89.52 | (18605, 3100, 9304)   |
| BIM      |      98.96 |              95.20 | (24104, 4017, 12055)  |
| CW       |      93.56 |              87.75 | (14674, 2445, 7339)   |
| Low_CW   |      90.12 |              84.41 | (3358, 559, 1683)     |
| FAB      |      96.75 |              92.39 | (15473, 2578, 7739)   |
| FGSM     |      92.78 |              86.19 | (15777, 2628, 7891)   |
| PGD      |      98.90 |              94.87 | (23855, 3975, 11931)  |
| Low_PGD1 |      78.78 |              72.43 | (2203, 365, 1106)     |
| Low_PGD2 |      88.59 |              81.52 | (7886, 1313, 3948)    |

- ResNet34


|          |   AUROC(%) |   Detection Acc(%) | #(train, dev, test)   |
|:---------|-----------:|-------------------:|:----------------------|
| DeepFool |      94.33 |              88.66 | (16354, 2725, 8180)   |
| BIM      |      99.57 |              97.43 | (23573, 3927, 11790)  |
| CW       |      90.29 |              84.11 | (11686, 1947, 5845)   |
| Low_CW   |      87.50 |              83.36 | (3035, 504, 1523)     |
| FAB      |      96.35 |              91.42 | (15002, 2499, 7504)   |
| FGSM     |      89.32 |              82.50 | (12162, 2026, 6084)   |
| PGD      |      99.49 |              97.21 | (23148, 3857, 11576)  |
| Low_PGD1 |      81.22 |              76.09 | (2268, 377, 1136)     |
| Low_PGD2 |      89.78 |              82.66 | (8342, 1389, 4174)    |



## 3. Transfer Attacks

- **Row**: Source
- **Column**: Target

**CIFAR10**

- VGG19

|          |   DeepFool |   BIM |    CW |   Low_CW |   FAB |   FGSM |   PGD |   Low_PGD1 |   Low_PGD2 |
|:---------|-----------:|------:|------:|---------:|------:|-------:|------:|-----------:|-----------:|
| DeepFool |      91.76 | 61.91 | 90.83 |    90.47 | 89.70 |  89.07 | 62.33 |      84.43 |      84.71 |
| BIM      |      65.76 | 99.79 | 81.70 |    41.25 | 43.87 |  82.32 | 99.78 |      63.43 |      96.45 |
| CW       |      88.16 | 69.72 | 88.31 |    87.83 | 84.78 |  88.94 | 71.69 |      80.25 |      86.33 |
| Low_CW   |      89.16 | 51.94 | 85.72 |    90.99 | 87.82 |  80.62 | 51.36 |      88.69 |      75.91 |
| FAB      |      95.84 | 43.01 | 93.17 |    92.47 | 97.30 |  91.51 | 44.71 |      82.60 |      76.42 |
| FGSM     |      84.70 | 72.84 | 88.67 |    81.27 | 79.18 |  90.67 | 75.32 |      74.65 |      84.20 |
| PGD      |      66.58 | 99.82 | 81.71 |    42.17 | 45.08 |  84.06 | 99.67 |      62.75 |      96.62 |
| Low_PGD1 |      77.68 | 69.07 | 80.04 |    82.66 | 77.93 |  77.01 | 69.56 |      80.74 |      81.79 |
| Low_PGD2 |      77.36 | 90.23 | 83.99 |    71.57 | 68.34 |  83.23 | 90.06 |      76.74 |      89.74 |


- ResNet34


|          |   DeepFool |   BIM |    CW |   Low_CW |   FAB |   FGSM |   PGD |   Low_PGD1 |   Low_PGD2 |
|:---------|-----------:|------:|------:|---------:|------:|-------:|------:|-----------:|-----------:|
| DeepFool |      92.94 | 73.10 | 89.64 |    86.91 | 94.01 |  84.39 | 75.35 |      87.59 |      91.40 |
| BIM      |      62.13 | 99.39 | 83.62 |    56.03 | 60.76 |  76.35 | 99.32 |      66.00 |      90.74 |
| CW       |      87.24 | 81.21 | 90.28 |    81.74 | 84.14 |  88.61 | 80.69 |      83.92 |      87.26 |
| Low_CW   |      84.41 | 62.76 | 84.19 |    82.58 | 85.55 |  72.83 | 67.99 |      88.52 |      84.09 |
| FAB      |      88.69 | 74.51 | 86.99 |    81.15 | 95.76 |  84.35 | 79.18 |      78.78 |      90.76 |
| FGSM     |      86.49 | 82.09 | 92.81 |    83.56 | 82.92 |  94.89 | 81.67 |      81.56 |      86.81 |
| PGD      |      59.23 | 99.42 | 82.57 |    57.65 | 56.27 |  75.99 | 99.28 |      64.20 |      90.35 |
| Low_PGD1 |      77.44 | 70.08 | 82.17 |    79.20 | 79.07 |  75.33 | 77.02 |      82.95 |      86.42 |
| Low_PGD2 |      85.74 | 92.84 | 90.4  |    80.67 | 86.79 |  85.36 | 91.48 |      85.76 |      90.07 |


**CIFAR100**

- VGG19

|          |   DeepFool |   BIM |    CW |   Low_CW |   FAB |   FGSM |   PGD |   Low_PGD1 |   Low_PGD2 |
|:---------|-----------:|------:|------:|---------:|------:|-------:|------:|-----------:|-----------:|
| DeepFool |      80.40 | 52.95 | 71.77 |    81.31 | 82.27 |  68.61 | 51.34 |      72.65 |      70.04 |
| BIM      |      46.63 | 86.14 | 57.88 |    53.55 | 41.39 |  61.81 | 90.2  |      56.72 |      73.45 |
| CW       |      75.26 | 72.30 | 72.53 |    69.18 | 72.60 |  67.45 | 65.02 |      66.54 |      71.74 |
| Low_CW   |      83.81 | 52.64 | 83.21 |    59.76 | 78.18 |  60.50 | 52.16 |      62.42 |      72.59 |
| FAB      |      84.15 | 53.52 | 72.35 |    74.60 | 76.26 |  58.67 | 54.37 |      65.21 |      66.54 |
| FGSM     |      72.34 | 61.55 | 71.93 |    67.63 | 71.73 |  63.77 | 62.16 |      63.21 |      64.98 |
| PGD      |      44.98 | 89.12 | 51.08 |    45.10 | 40.51 |  56.23 | 87.85 |      52.43 |      66.13 |
| Low_PGD1 |      76.10 | 57.68 | 73.99 |    75.12 | 77.17 |  61.20 | 62.45 |      55.68 |      75.67 |
| Low_PGD2 |      64.91 | 77.37 | 64.82 |    62.86 | 59.45 |  60.75 | 73.54 |      70.40 |      66.83 |


- ResNet34

TBD


**SVHN**

- VGG19


|          |   DeepFool |   BIM |    CW |   Low_CW |   FAB |   FGSM |   PGD |   Low_PGD1 |   Low_PGD2 |
|:---------|-----------:|------:|------:|---------:|------:|-------:|------:|-----------:|-----------:|
| DeepFool |      95.40 | 35.78 | 95.32 |    94.09 | 94.48 |  95.07 | 33.91 |      90.72 |      82.15 |
| BIM      |      32.30 | 98.96 | 31.01 |    22.10 | 34.79 |  31.10 | 99.05 |      55.46 |      91.36 |
| CW       |      93.02 | 40.19 | 93.56 |    92.91 | 92.86 |  93.21 | 38.05 |      90.77 |      85.13 |
| Low_CW   |      86.67 | 47.91 | 87.49 |    90.12 | 86.96 |  84.54 | 44.60 |      87.35 |      78.68 |
| FAB      |      95.67 | 40.36 | 95.64 |    95.64 | 96.75 |  95.33 | 38.83 |      91.82 |      83.18 |
| FGSM     |      92.08 | 38.91 | 92.23 |    90.46 | 91.06 |  92.78 | 36.37 |      87.41 |      80.92 |
| PGD      |      33.59 | 98.85 | 32.33 |    23.09 | 35.95 |  32.42 | 98.90 |      55.99 |      91.46 |
| Low_PGD1 |      72.79 | 63.26 | 74.54 |    76.43 | 70.40 |  69.07 | 59.46 |      78.78 |      77.47 |
| Low_PGD2 |      76.74 | 77.22 | 79.70 |    75.42 | 76.82 |  77.04 | 77.11 |      83.25 |      88.59 |


- ResNet34


|          |   DeepFool |   BIM |    CW |   Low_CW |   FAB |   FGSM |   PGD |   Low_PGD1 |   Low_PGD2 |
|:---------|-----------:|------:|------:|---------:|------:|-------:|------:|-----------:|-----------:|
| DeepFool |      94.33 | 53.61 | 93.78 |    89.50 | 91.69 |  91.08 | 55.08 |      86.06 |      77.35 |
| BIM      |      34.16 | 99.57 | 46.25 |    23.13 | 24.32 |  55.06 | 99.63 |      55.35 |      94.76 |
| CW       |      88.69 | 58.87 | 90.29 |    86.35 | 86.55 |  88.29 | 61.13 |      84.75 |      79.73 |
| Low_CW   |      87.76 | 54.83 | 87.18 |    87.50 | 87.62 |  80.50 | 57.36 |      87.41 |      80.00 |
| FAB      |      96.59 | 56.24 | 95.28 |    93.84 | 96.35 |  92.54 | 58.97 |      88.04 |      78.36 |
| FGSM     |      85.22 | 60.89 | 87.28 |    81.43 | 83.11 |  89.32 | 62.84 |      78.65 |      74.61 |
| PGD      |      35.69 | 99.55 | 48.53 |    24.24 | 25.97 |  55.67 | 99.49 |      55.93 |      94.37 |
| Low_PGD1 |      79.42 | 66.12 | 81.67 |    80.15 | 76.53 |  75.80 | 64.34 |      81.22 |      81.41 |
| Low_PGD2 |      73.31 | 84.54 | 80.64 |    70.08 | 68.54 |  76.95 | 84.60 |      81.43 |      89.78 |




# Citations

```bibtex
@article{kim2020torchattacks,
  title={Torchattacks: A pytorch repository for adversarial attacks},
  author={Kim, Hoki},
  journal={arXiv preprint arXiv:2010.01950},
  year={2020}
}
```